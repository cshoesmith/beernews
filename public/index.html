<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sydney Beer Weekly</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-left">
                <button class="menu-btn" aria-label="Menu">
                    <span></span><span></span><span></span>
                </button>
            </div>
            <!-- <div class="nav-right">Removed Subscribe</div> -->
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Navigation Overlay -->
        <div class="mag-nav-overlay">
            <button id="nav-prev" class="nav-arrow" aria-label="Previous Page">
                &lt;
            </button>
            <button id="nav-next" class="nav-arrow" aria-label="Next Page">
                &gt;
            </button>
        </div>

        <div id="magazine-container">
            <!-- Page Display -->
            <div id="page-spread">
                <div class="loading-screen" style="padding:40px; text-align:center;">
                    <h2>Sydney Beer Weekly</h2>
                    <p>Loading Issue...</p>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="mag-controls">
            <div class="control-bar">
                <span id="page-number-display">Cover</span>
                <div class="progress-rail">
                    <div id="mag-progress-bar" class="progress-fill"></div>
                </div>
                <span id="total-pages-display">16 Pages</span>
                <span onclick="toggleAdmin()" class="admin-link" style="cursor: pointer; margin-left:15px; font-size: 0.8rem;" title="Admin">Admin</span>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; color:white; align-items:center; justify-content:center;">
        <div style="width:100%; max-width:350px; background:#222; padding:30px; border-radius:8px; border:1px solid #444; box-shadow:0 0 20px rgba(0,0,0,0.8);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="margin:0;">Mag Admin</h3>
                <button onclick="closeLogin()" style="background:none; border:none; color:#aaa; font-size:24px; cursor:pointer;">&times;</button>
            </div>
            
            <p style="margin-top:0;">Password Required:</p>
            <!-- Pass Enter key to login -->
            <input type="password" id="admin-pw" placeholder="Enter password" 
                   onkeyup="if(event.key === 'Enter') verifyAdmin()"
                   style="width:100%; padding:10px; margin-bottom:15px; background:#333; border:1px solid #555; color:white; box-sizing:border-box;">
            
            <button onclick="verifyAdmin()" style="width:100%; padding:10px; background:var(--mag-accent, #ffcc00); border:none; color:black; font-weight:bold; cursor:pointer;">Login</button>
            <p id="login-error" style="color:#ff6b6b; display:none; margin-top:10px;">Incorrect Password</p>
        </div>
    </div>

    <!-- Admin Content Modal -->
    <div id="admin-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9998; color:white; padding:0; box-sizing:border-box; align-items: center; justify-content: center;">
        <div style="width: 100%; max-width:500px; margin:0; background:#222; padding:20px; border-radius:0; border:none; height: 100%; display: flex; flex-direction: column; box-sizing: border-box; overflow: hidden;">
            <style>
                @media (min-width: 501px) {
                    #admin-modal > div {
                        height: 90vh !important;
                        margin: 20px auto !important;
                        border-radius: 8px !important;
                        border: 1px solid #444 !important;
                    }
                }
            </style>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #444; padding-bottom:10px;">
                <h2 style="margin:0;">Mag Admin</h2>
                <button onclick="closeAdmin()" style="background:none; border:none; color:#aaa; font-size:24px; cursor:pointer;">&times;</button>
            </div>
            
            <div id="admin-content-step" style="display: flex; flex-direction: column; height: 100%; overflow:hidden;">
                
                <!-- Actions Panel -->
                <div style="background: #333; padding: 15px; border-radius: 6px; margin-bottom: 15px; flex-shrink: 0;">
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 10px;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.75rem; color: #aaa; display: block; margin-bottom: 4px;">STYLE: <span id="page3-style-label" style="color: #f1c40f;">Girl Next Door</span></label>
                            <input type="range" id="page3-style" min="0" max="2" value="1" style="width: 100%; accent-color: #f1c40f;">
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <label style="font-size:0.75rem; color:#ccc; cursor:pointer"><input type="radio" name="page3-mode" value="mosaic" checked> Mosaic</label>
                            <label style="font-size:0.75rem; color:#ccc; cursor:pointer"><input type="radio" name="page3-mode" value="natural"> Natural</label>
                        </div>
                    </div>
                    
                    <button id="btn-generate-mag" onclick="generateMagazine()" style="width:100%; padding: 10px; background: #e67e22; border:none; color: white; font-weight: bold; cursor: pointer; border-radius: 4px; font-size: 0.9rem;">
                        GENERATE NEW MAGAZINE
                    </button>
                    <div id="gen-status" style="font-size:0.75rem; color:#aaa; text-align:center; margin-top: 5px; height: 1em;"></div>
                </div>

                <script>
                    document.getElementById('page3-style').addEventListener('input', function() {
                        const labels = ['Business', 'Girl Next Door', 'Lingerie'];
                        document.getElementById('page3-style-label').textContent = labels[this.value];
                    });
                </script>

                <!-- Venues List (Expands) -->
                <div style="display: flex; flex-direction: column; flex: 1; overflow: hidden; margin-bottom: 15px; border: 1px solid #444; border-radius: 6px; background: #111;">
                    <div style="padding: 10px; border-bottom: 1px solid #333; background: #222; font-weight: bold; font-size: 0.9rem;">
                        Managed Venues
                    </div>
                    <div id="existing-venues-list" style="flex: 1; overflow-y: auto; padding: 0;">
                        <!-- Content populated by JS -->
                        <div style="padding: 10px; color: #666;">Loading...</div>
                    </div>
                </div>

                <!-- Add Venue (Fixed Bottom) -->
                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.9rem; margin-bottom: 5px; color: #aaa;">Add New Venue</h3>
                    <div style="display:flex; gap:8px;">
                        <input type="text" id="venue-search" placeholder="Search (e.g. Mountain Culture)" style="flex:1; padding:10px; background:#333; border:1px solid #555; color:white; border-radius: 4px;">
                        <button onclick="searchVenues()" style="padding:10px 15px; background:#444; border:1px solid #555; color:white; cursor:pointer; border-radius: 4px;">Go</button>
                    </div>
                    <div id="search-results" style="margin-top:10px; max-height:150px; overflow-y:auto; background: #1a1a1a; position: absolute; width: calc(100% - 60px); z-index: 100;">
                        <!-- Search results overlay -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js?v=6"></script>
</body>
</html>
